# アイキューブ本部便発送システム ユーザーマニュアル

## 目次
1. [システム概要](#システム概要)
2. [ログイン方法](#ログイン方法)
3. [ユーザー権限について](#ユーザー権限について)
4. [ダッシュボード](#ダッシュボード)
5. [備品管理](#備品管理)
6. [発送管理](#発送管理)
7. [一括登録機能](#一括登録機能)
8. [その他機能](#その他機能)
9. [よくある質問](#よくある質問)

---

## システム概要

アイキューブ本部便発送システムは、社内の備品管理と発送業務を効率化するためのWebアプリケーションです。

### 主な機能
- 備品マスタの登録・管理
- 発送登録・履歴管理
- CSV/Excelファイルによる一括登録
- 部署別のアクセス権限管理
- 発送履歴の検索・フィルタリング

### 対応ブラウザ
- Google Chrome（推奨）
- Microsoft Edge
- Mozilla Firefox
- Safari

---

## ログイン方法

システムへのアクセスは認証が必要です。

### 1. Microsoft Entra ID ログイン（推奨）
1. ログイン画面で「Microsoft Entra ID でログイン」ボタンをクリック
2. 社内のMicrosoftアカウントでログイン
3. 自動的にシステムにリダイレクトされます

### 2. メールアドレス・パスワードログイン
1. メールアドレス欄に社内メールアドレスを入力
2. パスワード欄にパスワードを入力
3. 「ログイン」ボタンをクリック

### ログイン時の注意事項
- 社内ネットワークからのアクセスが必要です
- ログイン情報を忘れた場合は、システム管理者にお問い合わせください

---

## ユーザー権限について

システムでは2つのユーザー権限があります。

### 部署ユーザー（DEPARTMENT_USER）
- **制限事項**: 自分の所属部署の備品のみ操作可能
- **可能な操作**:
  - 自部署の備品登録・編集
  - 自部署の備品からの発送登録
  - 発送履歴の閲覧（自部署関連のみ）

### 管理ユーザー（MANAGEMENT_USER）
- **制限事項**: 備品の登録・編集は自分の部署のみ
- **可能な操作**:
  - 全部署の備品閲覧
  - 自部署の備品登録・編集・発送
  - 全部署の発送履歴閲覧
  - 部署別フィルタリング機能の利用

---

## ダッシュボード

ログイン後最初に表示される画面です。

### クイックアクション
よく使用する機能に素早くアクセスできます：

- **備品登録**: 新しい備品をマスタに追加
- **発送登録**: 新しい発送を作成
- **一括登録**: CSVファイルから発送データを一括登録

### 最近の発送履歴
- デフォルトで過去7日〜未来7日の発送履歴を表示
- 管理ユーザーは発送元・発送先でフィルタリング可能
- 開始日・終了日で期間指定可能
- **表示件数選択**: 25件、50件、100件から選択可能（デフォルト50件）
- **ページネーション**: 表示件数を超える場合、自動的にページ分割表示

### 表示される情報
- 発送日
- 備品名
- 数量
- 発送先
- 担当者
- 発送者
- 発送元部署

---

## 備品管理

### 備品一覧画面
- 備品名・部署名で検索可能
- ページネーション機能（1ページ20件表示）
- 発送回数の表示

### 備品登録
1. ダッシュボードまたは備品一覧から「新しい備品を登録」をクリック
2. 必要な情報を入力：
   - **備品名**（必須）
   - **単位**（例：個、セット、箱）
3. 「登録」ボタンをクリック

### 備品編集
1. 備品一覧で編集したい備品の「編集」ボタンをクリック
2. 情報を修正して「更新」ボタンをクリック

### 権限による制限
- 自分の部署以外の備品は編集・発送ができません
- 該当ボタンは灰色で表示され、クリックできません

---

## 発送管理

### 発送登録
1. 「発送登録」画面で以下の情報を入力：
   - **備品**（必須）: プルダウンから選択
   - **数量**（必須）: 数値入力
   - **発送先部署**（必須）: プルダウンから選択
   - **担当者**: 任意入力
   - **追跡番号**: 任意入力
   - **備考**: 任意入力
   - **発送日時**: 省略可（現在日時で登録）

2. 「登録」ボタンをクリック

### 発送履歴の閲覧
- 発送一覧画面で全ての発送履歴を確認
- **表示件数選択**: 25件、50件、100件から選択可能（デフォルト50件）
- **ページネーション**: 表示件数を超える場合、自動的にページ分割表示
- 以下の条件でフィルタリング可能：
  - 備品名
  - 発送先
  - 発送元部署（管理ユーザーのみ）
  - 発送日期間
  - 表示件数

### 発送編集・削除
- 自分の部署で登録した発送のみ編集・削除可能
- 他部署の発送データは閲覧のみ

---

## 一括登録機能

CSV/Excelファイルを使用して複数の発送データを一度に登録できます。

### 対応ファイル形式
- CSV (.csv)
- Excel (.xlsx, .xls)
- ファイルサイズ上限: 10MB

### テンプレートのダウンロード
1. 一括登録画面で「テンプレートをダウンロード」をクリック
2. サンプルデータ付きのCSVファイルがダウンロードされます

### 必要な列
- **item_name**: 備品名（必須）
- **quantity**: 数量（必須）
- **destination_department_name**: 発送先部署名（必須）
- **shipment_user_name**: 担当者名（任意）
- **tracking_number**: 追跡番号（任意）
- **notes**: 備考（任意）
- **shipped_at**: 発送日時（任意、形式: YYYY-MM-DD HH:MM）

### アップロード手順
1. ファイルをドラッグ&ドロップまたは「ファイルを選択」でアップロード
2. システムが自動的にデータを検証・処理
3. 結果が表示されます：
   - 成功件数
   - エラー件数
   - エラー詳細（エラーがある場合）

### エラー処理
- **全件ロールバック**: 1件でもエラーがあれば全件登録されません
- エラー詳細表示: 行番号とエラー内容を確認可能
- 文字エンコード自動検出: Shift_JIS、UTF-8に対応

---

## その他機能

### 部署管理
- 管理ユーザーは全部署一覧を閲覧可能
- 部署別の管理フラグ確認

### ユーザー管理
- 部署別のユーザー一覧表示
- ユーザーの権限確認

### 検索・フィルタ機能
- 備品：備品名・部署名での検索
- 発送：複数条件での絞り込み
- **ページネーション対応**：
  - ダッシュボードの最近の発送履歴：25件、50件、100件から選択可能
  - 発送一覧：25件、50件、100件から選択可能
  - 表示件数変更時は自動的にページ1に戻る

---

## よくある質問

### Q: ログインできません
**A:** 以下をご確認ください：
- 社内ネットワークに接続していますか？
- メールアドレス・パスワードは正しいですか？
- Microsoft Entra IDアカウントは有効ですか？

### Q: 他部署の備品が編集できません
**A:** システムの仕様です。各部署は自分の部署の備品のみ編集可能です。他部署の備品編集が必要な場合は、該当部署に直接ご依頼ください。

### Q: 一括登録でエラーが発生します
**A:** 以下をご確認ください：
- ファイル形式はCSV/Excelですか？
- 必須項目（備品名、数量、発送先部署名）は入力されていますか？
- 備品名は既存の備品マスタに登録されていますか？
- 発送先部署名は正確ですか？

### Q: 発送履歴が表示されません
**A:** 以下をご確認ください：
- 検索期間は適切ですか？
- フィルタ条件が厳しすぎませんか？
- 権限の範囲内でデータを検索していますか？

### Q: CSVファイルの文字化けを回避するには？
**A:** システムは自動的に文字エンコードを検出しますが、以下をお勧めします：
- ExcelからCSV保存時は「UTF-8」を選択
- メモ帳等で保存する場合も「UTF-8」を選択

### Q: システムの動作が遅いです
**A:** 以下をお試しください：
- ブラウザを最新版に更新
- ブラウザのキャッシュをクリア
- 他のタブやアプリケーションを閉じる
- 社内ネットワークの状況を確認

### Q: ページネーションの表示件数を変更するには？
**A:** 以下の手順で変更できます：
- ダッシュボードの「最近の発送履歴」：フィルター操作エリアの「表示件数」で25件、50件、100件から選択
- 発送一覧画面：検索・フィルターエリアの「表示件数」で25件、50件、100件から選択
- 表示件数を変更すると自動的にページ1に戻ります

### Q: ページネーションが表示されません
**A:** 以下をご確認ください：
- データ件数が選択した表示件数を超えていますか？
- 表示件数以下の場合、ページネーションは表示されません
- フィルタ条件を緩くしてデータ件数を増やしてみてください

---

## お問い合わせ

システムに関するお問い合わせは、社内システム管理者までご連絡ください。

**最終更新日**: 2025年9月

---